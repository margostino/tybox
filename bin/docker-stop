#!/bin/bash

# Colors for output
RED='\033[0;31m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Get service arguments or use all services if none provided
SERVICES="$@"

if [ -z "$SERVICES" ]; then
  echo -e "${YELLOW}Stopping all Tybox services...${NC}"
  # Stop and remove all containers
  docker-compose down
  echo -e "${RED}All services have been stopped${NC}"
else
  echo -e "${YELLOW}Stopping specified services: $SERVICES${NC}"
  # Stop specific services
  docker-compose stop $SERVICES
  docker-compose rm -f $SERVICES

  # List which services were stopped
  for service in $SERVICES; do
    echo -e "${RED}âœ“ $service stopped${NC}"
  done
fi

# Show remaining running services if any
RUNNING=$(docker-compose ps --services --filter "status=running" 2>/dev/null)
if [ ! -z "$RUNNING" ]; then
  echo ""
  echo -e "${BLUE}Services still running:${NC}"
  echo "$RUNNING" | while read -r service; do
    echo "  - $service"
  done
fi

# Optional: Remove volumes (uncomment if you want to clean data)
# echo -e "${YELLOW}Removing volumes...${NC}"
# docker-compose down -v